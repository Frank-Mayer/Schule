<script defer>
  (async () => {
    const user = location.host.split(".")[0];
    const path = location.pathname.split("/").filter(Boolean);
    const repo = path.shift();
    const response = await fetch(
      `https://api.github.com/repos/${user}/${repo}/contents/${path.join("/")}`
    );
    const data = await response.json();

    const navEl = document.createElement("nav");
    const ulEl = document.createElement("ul");
    navEl.appendChild(ulEl);

    for (const file of data) {
      if (file.name.startsWith("_")) {
        continue;
      }

      if (
        file.type === "dir" ||
        (file.name.endsWith(".md") &&
          file.name !== "README.md" &&
          file.name !== "LICENSE.md") ||
        file.name.endsWith(".html")
      ) {
        const liEl = document.createElement("li");
        const aEl = document.createElement("a");
        aEl.href = file.path;
        aEl.textContent = file.name;
        liEl.appendChild(aEl);
        ulEl.appendChild(liEl);
      }
    }

    document.body.prepend(navEl);
  })();
</script>
